[tox]
envlist=code-check,pytest-check
skipsdist=True

[testenv:code-check]
basepython = python3
setenv =
    PYTHONPATH = {toxinidir}
deps=
    pre-commit
commands =
    pre-commit clean
    pre-commit run --all-files
    rm -rf {envdir}
whitelist_externals =
    rm

[testenv:pytest-check]
basepython = python3
setenv =
    PYTHONPATH = {toxinidir}
    LC_ALL = en_US.utf8
    LANG = en_US.utf8
    PIPENV_NOSPIN = "true"
    PIPENV_HIDE_EMOJIS = "true"
deps=
    pipenv
commands =
    pipenv install --skip-lock
    pipenv run pytest --collect-only
    pipenv run pytest --upgrade=cnv --cnv-version=NA --collect-only
    pipenv run pytest --upgrade=ocp --ocp-image=NA --collect-only
    rm -rf {envdir}
whitelist_externals =
    rm
